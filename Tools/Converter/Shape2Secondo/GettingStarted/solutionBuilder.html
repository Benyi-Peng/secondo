<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>

<HEAD>
	<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=iso-8859-1">
	<META NAME="GENERATOR" Content="Visual Page 2.0 for Windows">
	<META NAME="Author" Content="Linda Oxnard">
	<TITLE>untitled</TITLE>
</HEAD>

<BODY>

<H1>Getting Started as a Solution Builder:</H1>
<H2>Prerequisites:</H2>
<P>This document introduces some elements of Java programing and, whilst you might pick it up as you go along,
you might want to look for other tutorial material if you have no Java experience.&nbsp; In particular, the ability
to knock an applet together would be a good start.</P>
<P>It might also help if you have had a glance through the 'end user' guide, as a quick introduction to GeoTools
applets. <BR>
&nbsp;
<H2>Things to get:</H2>
<P>You should download the latest copy of the GeoTools examples and demos package. This comes in a file named demos.zip.&nbsp;
At the time of writing, this is version 1.1 which can be downloaded from the main GeoTools <A HREF="http://sourceforge.net/project/showfiles.php?group_id=4091">download
site.</A></P>
<P>Grab a copy of the latest 'geotools-docs' package. Whilst you are there, go for the most recent, regardless
of whether it is marked 'dev' or not.&nbsp; Alternatively, add a bookmark to <A HREF="http://geotools.sourceforge.net/docs">http://geotools.sourceforge.net/docs</A>&nbsp;which
will always contain an online copy of the very latest&nbsp;API documentation. Be warned, however, that there may
occasionally be features documented which are not yet available in the 'examples and demos' package you have downloaded.</P>
<P>Optionally, you might want to grab a copy of the main GeoTools source code. You won't be modifying it yet, but
it can often be a handy reference when the API documentation is too obscure to help you out.&nbsp; At any one time,
there may be two versions of the source code available: a release and a developers release (dev). At the time of
writing, it is almost certainly best to grab whichever one has the most recent date stamp.</P>
<P>You will also need a Java compiler that is at least up to version 1.1.</P>
<P>Finally, you need a web browser that supports Java 1.1: for example, Netscape 4.06 or higher and IE5 or higher.&nbsp;
Make sure that you choose a download option that includes a Java Virtual Machine as some do not include this by
default. <BR>
&nbsp;
<H2>Compiling a GeoTools applet:</H2>
<P>Unpack the demos.zip archive and open the readme.html file that is provided.&nbsp; Take a quick look at each
example in turn by clicking on the view links. For more details, look at the 'Getting Started as an End User' guide.</P>
<P>If you open the demonstrations folder, you will find all the files and sub directories that are used by all
of the demos you have just been playing with. For example, the first demo uses: <BR>
<TT>Example1.html</TT> <BR>
<TT>Example1.class</TT> <BR>
<TT>jars\geotools.jar</TT> <BR>
<TT>jars\collections.jar</TT> <BR>
<TT>jars\support.jar</TT> <BR>
<TT>maps\statepop.zip</TT></P>
<P>In addition to these files, there is also a file called Example1.java. This is the file we are now interested
in, as it is the source code of the applet used in Example1.</P>
<P>The first thing to do is to try and compile the applet without making any modifications to it. If all is well
and you get no errors, then we can look at how the source code works. <BR>
Depending on your java development environment, you might need to change the following statement (refer to your
compiler's documentation for details).</P>
<P><TT>&nbsp;javac -classpath jars/geotools.jar:jars/collections.jar Example1.java</TT></P>
<P>With any luck, you won't receive any error messages,&nbsp;but if you do, and you can't work out what is causing
them, then make a copy of the messages and submit a 'getting started' <A HREF="http://sourceforge.net/tracker/?group_id=4091&atid=204091">support
request</A>, including as many details as you can about the errors, along with the OS and java development environment
that you are using.</P>
<P>As a final test, try running the applet to check it is still working. You can do this either by opening Example1.html
in your web browser or by using 'appletviewer'.</P>
<P><TT>&nbsp;appletviewer Example1.html</TT> <BR>
&nbsp;
<H2>Taking a look at the source code for Example1</H2>
<P>Assuming you are still with us, then open up Example1.java in your favourite text editor and take a look at
the code.&nbsp; With any luck, the comments in the code will provide some clues as to what is going on, but in
any case I'll run through the main points here (with the comments removed for compactness).</P>
<P><TT>import java.applet.*;</TT> <BR>
<TT>import java.awt.*;</TT> <BR>
<TT>import java.net.*;</TT> <BR>
<TT>import java.io.*;</TT> <BR>
<TT><B>import uk.ac.leeds.ccg.geotools.*;</B></TT><B> <BR>
</B><TT><B>import uk.ac.leeds.ccg.widgets.ToolBar;</B></TT></P>
<P>Most of these are standard Java imports, but the last two import GeoTools specific classes: the main GeoTools
library and a class called 'ToolBar' from a supporting 'widgets' package.</P>
<P><TT>public class Example1 extends Applet</TT> <BR>
<TT>{</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp; Viewer <B>view</B> = new Viewer();</TT></P>
<P>The Viewer class is the component in which the map is actually displayed. In this case, an instance of Viewer
called <B>view</B> is constructed.&nbsp; It is, unsurprisingly, one of the most important classes in GeoTools and,
if you have the source code to hand, you will see it is also one of the more complex ones.</P>
<P>However, you don't need to know its details for now, just that it will provide the view port in which the map
will be displayed.</P>
<P><TT>public void <B>init</B>(){</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; setLayout(new <B>BorderLayout</B>());</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add(<B>view</B>,&quot;Center&quot;);</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ToolBar <B>tools</B> = new ToolBar(view);</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add(tools,&quot;South&quot;);</TT> <BR>
<TT>}</TT></P>
<P>The <B>init</B> method of applets are called before the applet is displayed, so the code here is used to set
out the components in the applet.</P>
<P>The main things to note are that a <B>BorderLayout</B> is used with the <B>view</B> object added in the centre.&nbsp;
This is a useful convention as it allows the map to expand to fill the available space.</P>
<P>Next, note how the ToolBar object (<B>tools</B>) is constructed. It takes a 'Viewer' as an argument.&nbsp; ToolBar
widgets provide a handy set of controls for interacting with viewers and so need to know which viewer they will
be controlling when they are set up.</P>
<P>There is nothing magical about the ToolBar widget and it is relatively easy to ignore it and set up your own
interface controls if you are reasonably competent with the AWT.&nbsp; Take a look at ToolBar's source code for
some clues.</P>
<P><TT>public void <B>start</B>(){</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <B>try</B>{</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; loadMaps();</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <B>catch</B>(IOException e){</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.showStatus(&quot;Error loading map
file &quot;+e);</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp; }</TT></P>
<P>Once the applet is fully loaded and the<B> </B>init() method has completed, the applet's <B>start</B> method
is called. This one simply calls another method to load all of the map data.</P>
<P>The use of the <B>try/catch</B> block is just to pick up an error that might occur during the loading process,
such as a missing or corrupted file.</P>
<P><TT>public void loadMaps() throws IOException{</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String shapefile = this.getParameter(&quot;shapefile&quot;);</TT>
<BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; URL url = new URL(getCodeBase(),shapefile);</TT> <BR>
<TT>&nbsp;</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ShapefileReader <B>sfr</B> = new ShapefileReader(url);</TT> <BR>
<TT>&nbsp;</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Theme t = sfr.getTheme();</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; view.addTheme(t);</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp; }</TT></P>
<P>This is the map loading method called by the start method. The first thing the method does is to find out the
name and location of the map to be loaded (in this case, the information is obtained from a param tag in the html
file which accompanies the applet).&nbsp; Take a look at the source for Example1.html and you will find a line
which reads &lt;param name=&quot;shapefile&quot; value=&quot;maps/statepop&quot;&gt;. It is the maps/statepop value
which is picked up here.&nbsp; Once fetched, the information is used to build a full URL.</P>
<P>Next, a ShapefileReader (<B>sfr</B>) is set up to pull information from the specified shapefile.&nbsp; There
are a number of 'Reader' classes in GeoTools for different file formats&nbsp;although, at the time of writing,
the ShapefileReader is the most stable and well supported reader.</P>
<P>The ShapefileReader is then used to construct a theme object (<B>t</B>) from the data available to it.&nbsp;
In GeoTools, 'Themes' contain all of the information relating to a geographic feature set, including colouring,
attribute data, labelling and the features themselves.&nbsp; Actually, Themes do not hold this information directly,
instead they use a collection of other objects, including a Layer (which holds the geography itself), a GeoData
object which holds attribute information, a Shader (which maps the GeoData values to colours for shading), a ShadeStyle&nbsp;(which
controls aspects of how the features are drawn), and a fair few more besides.</P>
<P>What is important here, however, is that ShapefileReader hides all of this construction for you, providing default
options to all of the above except the Layer object which it what it built from the shapefile itself.</P>
<P>As you will see in the later demos, there are more getTheme options which provide more control over how the
Theme should be constructed. Even then, you can call methods on the theme object itself to change its configuration.</P>
<P>Finally, the theme (<B>t)</B> is added to the 'view' object.&nbsp; With that done, everything else is on autopilot.&nbsp;
GeoTools will scale and plot the map, whilst the ToolBar widget handles the selection of zoom and pan modes for
the viewer.</P>
<P>The remaining methods in the applet only provide information on the applet and are not relevant to the discussion.
<BR>
&nbsp;</P>
<P>A key thing to note at this point is that the file specified in the html is given without an extension. This
is because it might be one of several.&nbsp; Typically, shapefiles actually come as one, two, three or more separate
files: an .shp file containing the features, a .dbf file containing attribute data, and an .shx file which acts
as an index.&nbsp; Additional files provide more indexing information but are not needed (in fact, GeoTools can
live without the .shx and even the .dbf ).&nbsp; GeoTools provides the option to deploy these files in a zipped
archive so, by not specifying an extension, GeoTools will hunt first for a zip file and then for the files individually.

<BLOCKQUOTE>
	<P>&nbsp;
</BLOCKQUOTE>

<H2>Taking a look at the code for Example 2</H2>
<P>I won't go through the complete code here as almost all of it is identical to the previous example, so I'll
just go over the new lines in the loadMaps method, which is the only one to change. <BR>
<TT>&nbsp;</TT> <BR>
<TT>&nbsp;String tooltip = this.getParameter(&quot;tooltip&quot;);</TT> <BR>
<TT>&nbsp;GeoData tips = sfr.readData(tooltip);</TT> <BR>
<TT>&nbsp;t.<B>setTipData</B>(tips);</TT> <BR>
<TT>&nbsp;</TT> <BR>
Example 2 adds tooltips to the map.&nbsp; These provide popup information on features that are currently under
the mouse. They appear whenever the mouse is stationary for a short period of time.</P>
<P>To set them up, an extra param tag is needed in the html file for the applet. This should be set to the name
of a column in the .dbf file.</P>
<P>If you don't know what columns are in your dbf file, than you have a few options. First, you could open the
.dbf file in an application such as Excel, StarOffice (or even ArcView if you have a copy). Alternatively, if you
use the appletviewer command to run Example1, you will see that part of the output looks something like this:</P>

<BLOCKQUOTE>
	<P><TT>Found .dbf in zip file</TT> <BR>
	<TT>Loaded as STATE_NAME</TT> <BR>
	<TT>Loaded as STATE_FIPS</TT> <BR>
	<TT>Loaded as SUB_REGION</TT> <BR>
	<TT>Loaded as STATE_ABBR</TT> <BR>
	<TT>Loaded as LAND_KM</TT> <BR>
	<TT>Loaded as WATER_KM</TT> <BR>
	<TT>Loaded as PERSONS</TT> <BR>
	<TT>Loaded as FAMILIES</TT> <BR>
	<TT>...</TT></P>
	<P>Each one of those represents an available column in the .dbf file. <BR>
	&nbsp;
</BLOCKQUOTE>

<P>The shapefile reader is used to pull the specified column from the .dbf file and package it into a GeoData object,
which in this case is set up as 'tips'.&nbsp; GeoData is actually a very simple interface which defines a data
source capable of linking ID values with data values.&nbsp; In most cases, this means that each feature in a layer
has an ID which can be linked to a data value through calls to a GeoData object.&nbsp; Most of the time, this linking
is transparent as it is handled by the Theme object (which is what is happening in the last line of new code).
The <B>setTipData(</B>GeoData<B>)</B> method of theme is called to store the tip data alongside the geographic
features.</P>
<P>Other than those three lines and the change to the html file, no more alterations are needed. <BR>
&nbsp;
<H3>Taking a look at the code for Example 3</H3>
<P>Example 3 finally adds some colour to the map. Again, this example builds on the first two, so only the new
lines will be covered.</P>
<P><TT>public class Example3 extends Applet</TT> <BR>
<TT>{</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp; Viewer view = new Viewer();</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp; Panel <B>keys</B> = new Panel();</TT></P>
<P>With the addition of colour, it is important to add a key. The <B>keys</B> panel constructed here will act as
a holder for the key when it is available.</P>
<P><TT>public void init(){</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; add(keys,&quot;East&quot;);</TT> <BR>
<TT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...</TT> <BR>
<TT>&nbsp; }</TT></P>
<P>The extra line in the init method just says where we would like the key holding panel to be placed.</P>
<P><TT>public void loadMaps() throws IOException{</TT> <BR>
<TT>&nbsp;&nbsp; ...</TT> <BR>
<TT>&nbsp;&nbsp; String shadeby = this.getParameter(&quot;shadeby&quot;); //this should be the name of a column
in the dbf file</TT></P>
<P>Another param tag is needed: this time to state which column the data for shading should come from. <BR>
<TT>&nbsp;</TT> <BR>
<TT>&nbsp;&nbsp; GeoData shadeData = sfr.readData(shadeby);</TT></P>
<P>The data itself is pulled out, in much the same way as the tooltip data was obtained in the last example. <BR>
<TT>&nbsp;</TT> <BR>
<TT>&nbsp;&nbsp; Shader shade = new ClassificationShader(shadeData,6,ClassificationShader.QUANTILE,Color.green,Color.orange);</TT></P>
<P>Shader objects are another key component in GeoTools. The Shader interface is actually a very simple interface
which states that implementers should be able to return a colour for any data value.&nbsp;&nbsp;The ClassificationShader
is quite a complex implementation of the Shader interface that is able to divide a set of numbers into bins and
associate a colour with each bin.&nbsp; In this example, the data which it works the bins out from is in shadeData
(6 bins are to be created, using a quantile algorithm). The first bin will be coloured green whilst the last will
be shaded orange, with the intermediate bins taking colours in between.</P>
<P><TT>&nbsp;&nbsp; Theme t = sfr.getTheme();</TT></P>
<P>The theme object is constructed as before. <BR>
<TT>&nbsp;</TT> <BR>
<TT>&nbsp;&nbsp; t.setShader(shade);</TT> <BR>
<TT>&nbsp;&nbsp; t.setGeoData(shadeData);</TT> <BR>
<TT>&nbsp;</TT> <BR>
These two configure the theme to use the shader constructed above and to use the shadeData object for feature values.&nbsp;
It is important to note that it is not enough to just pass shadeData to the ClassificationShader above. It must
also be passed to the theme as above.</P>
<P>There are a number of reasons for this, one being that not all shaders need a GeoData object in order to be
constructed. Another is that you do not need to pass the same GeoData object to the shader as you do to the theme
(although, in most cases, this is what you will be doing). <BR>
<TT>&nbsp;</TT> <BR>
<TT>&nbsp;&nbsp; keys.add(shade.getKey());</TT></P>
<P>Finally, you get the actual Key from the shader and add it to the keys panel which we set up earlier. <BR>
&nbsp;
<H2>Where next?</H2>
<P>OK, so you know how to compile an applet and you know how three simple example applets work. Where do you go
from here?</P>
<P>Well, there are currently two more examples in the demos package (although Example 4 only shows the addition
of a simple 'zoom control' widget).&nbsp; GraphApplet, on the other hand, adds a whole host of new features and,
crucially, introduces the concept of HighlightManagers.</P>
<P>GraphApplet could do with a tutorial in its own right but, until that gets written, see what you can make out
from the source code.</P>
<P>If you want some exercises, try adding the ability to load more than one map into the viewer, or see if you
can get any of the other shader types to work.&nbsp; MonoShader and HSVShader are two that are worth a look.</P>
<P>If you like learning from source code, then take a look at the online demos list as a lot of these have source
code available. <BR>
<A HREF="http://geotools.sourceforge.net/demos.php">http://geotools.sourceforge.net/demos.php</A></P>
<P>In particular, you might want to look at the 'Village' demo.</P>
<P>In addition to this intro guide, I hope to post additional guides on specific topics such as Highlight and Selection
managers, Style objects and special Layer types. <BR>
&nbsp;
<H2>But GeoTools can't do X</H2>
<P>If you find that, no matter how hard you look through the samples available or through the API documentation,
you can't find a feature that you desperately need, then there are a few options open to you.</P>
<P>First, submit a feature request. We will try to accommodate requests if practical, especially if they will be
of use to a wide range of users.&nbsp; Of course, if you can provide financial incentive to develop your required
feature, we can make it a top priority.</P>
<P>Your second option is to join the <A HREF="http://lists.sourceforge.net/lists/listinfo/geotools-discussion">geotools-discussion</A>
mailing list and see if anyone else is already developing such a feature, or if they are prepared to work on it
either for you or with you.</P>
<P>Finally, of course, you can get your hands dirty by diving in and developing the extra features yourself.&nbsp;
If you are a reasonably competent programmer, then take a look at the: <A HREF="developer.html">'Getting Started
as a Developer' </A>guide and get stuck in.
<H2>Trouble shooting and getting help</H2>
<P>If you get completely stuck with some technical aspect of getting started, then please submit a support request
to the GeoTools development site on SourceForge.</P>
<P>To submit a support request, go to the project's development home page at: <BR>
<A HREF="http://sourceforge.net/projects/geotools/">http://sourceforge.net/projects/geotools/</A></P>
<P>Pick the 'support' option from the list across the top of the page. On the next page, choose 'submit'. <BR>
You do not need to be a member on SourceForge to use this form. However, if you are then you will be able to use
the SourceForge site to track your request more closely.</P>
<P>Pick 'Getting Started' from the category list and then provide a summary and any other details you can think
of.</P>
<P>If you do get started and want some more guidance on how to achieve a specific setup, or how a particular feature
works, then feel free to either submit a support request as above or, better still, join the geotools-discusion
mailing list and post your queries there, where you will have the attention of all of the developers and a wide
range of users, some of whom might have tried what you are trying to do.</P>

<P>For details on the mailing list archive and to sign up as a subscriber go to: <BR>
<A HREF="http://lists.sourceforge.net/lists/listinfo/geotools-discussion">geotools-discussion</A>&nbsp; <BR>
&nbsp;

</BODY>

</HTML>