#!/bin/sh
#
# TestRunner Startup Script
#
# 31.01.2006, M. Spiekermann

if [ "$1" != "--no-tmp" ]; then

dateStr=$(date +%Y_%m%d_%H%M%S)
tempDir="/tmp/$USER/TestRunner_$dateStr"
mkdir -p $tempDir
export SECONDO_PARAM_SecondoHome="$tempDir"
export SECONDO_PARAM_RTFlags=""

# On linux the variable below will use a less efficient
# malloc implementation which does error detection and aborts
# the process as soon as an error is recognized.
export MALLOC_CHECK_=2

else
 shift
fi

runner="$(which SecondoBDB) -test"
# check if nice command is present
ncmd=$(which nice)
if [ $? -ne 0 ]; then
   $runner $*
else
  nice -n 19  $runner $*
fi

rc=$?

rm -rf $tempDir

exit $rc
