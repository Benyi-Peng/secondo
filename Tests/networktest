# a test for the MON Algebra
# run with : Runner -c MyConfig.config < montest
# (Runner can be found in directory UserInterfaces)

# clean up what may be left over from e.g. a segfault
delete database networktest;

#setup
create database networktest;
open database networktest;
e

(create r : (rel(tuple((id int)(length real)(curve line)(kind bool)(start bool)))));
(update r := ((rel(tuple((id int)(length real)(curve line)(kind bool)(start bool))))(
(1 702.623 ((97 118 37 136)(97 118 118 147)(186 135 118 147)(214 154 186 135)(214 154 288 155)(254 223 288 155)(254 223 386 209)(386 209 457 179)(457 179 518 202)(518 202 591 180)) TRUE TRUE )
(2 437.922 ((229 89 153 48)(214 154 229 89)(162 198 214 154)(162 198 206 242)(152 310 206 242)(152 310 167 376)) TRUE TRUE )
(3 322.251 ((254 223 331 277)(331 277 326 324)(326 324 414 332)(414 332 505 315)) TRUE TRUE )
(4 278.593 ((386 209 334 135)(379 105 334 135)(379 105 358 41)(358 41 419 14)) TRUE TRUE )
)));

(create j : (rel(tuple((r1id int)(meas1 real)(r2id int)(meas2 real)(cc int)))));
(update j := ((rel(tuple((r1id int)(meas1 real)(r2id int)(meas2 real)(cc int))))(
( 1 201.33542 2 153.06224 255 )
( 1 351.36849 3 0.0 255 )
( 1 484.10884 4 0.0 255 )
)));

let n = thenetwork( r, j );

#testcase Routes
#yields (int 4)
query routes(n) count;

#testcase Junctions
#yields (int 6)
query junctions(n) count;

#testcase Sections 
#yields (int 8)
query sections(n) count;

#teardown
close database;
delete database networktest;

