#This file is part of SECONDO.
#
#Copyright (C) 2004, University in Hagen, Department of Computer Science, 
#Database Systems for New Applications.
#
#SECONDO is free software; you can redistribute it and/or modify
#it under the terms of the GNU General Public License as published by
#the Free Software Foundation; either version 2 of the License, or
#(at your option) any later version.
#
#SECONDO is distributed in the hope that it will be useful,
#but WITHOUT ANY WARRANTY; without even the implied warranty of
#MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#GNU General Public License for more details.
#
#You should have received a copy of the GNU General Public License
#along with SECONDO; if not, write to the Free Software
#Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
#
# a test for the ftext algebra
# run with : Runner -c MyConfig.config < ftexttest
# (Runner can be found in directory UserInterfaces)

# clean up what may be left over from e.g. a segfault
delete database ftexttest;

#setup
create database ftexttest;
open database ftexttest;
e

(create textrel1 : (rel(tuple((no int)(t text)))));
(update textrel1 := ((rel(tuple((no int)(t text))))
(
  (1 <text>Victor Teixeira de Almeida</text--->)
  (2 <file>JNI.ini</file--->)
)));

(create textrel2 : (rel(tuple((no int)(s string)))));
(update textrel2 := ((rel(tuple((no int)(s string))))
(
  (1 "Victor")
  (2 "nothing")
  (3 "W9uIGZp")
)));

#testcase Filter1
#yields ((rel(tuple((no int))))((1)))
query textrel1 feed filter[.t contains "Victor"] project[no] consume;

#testcase Filter2
#yields (int 996)
query textrel1 feed extend[l: length(.t)] sum[l]

#testcase Join1
#yields ((rel(tuple((no int)(no_s int))))((1 1)(2 3)))
query textrel1 feed textrel2 feed {s} product filter[.t contains .s_s] project[no, no_s] consume 

#teardown
close database;
delete database ftexttest;

