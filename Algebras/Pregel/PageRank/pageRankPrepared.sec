open database pagerank;

let InitMessages = AddRoutingAddress(Pages feed projectextend[Id; Value: 1.0]) consume;

query setupPregel(Workers);

query setPregelFunction(ComputeRouted, Address);

query InitMessages feed initPregelMessages;

query pregelStatus();
query startPregel(20);



#
# TEST
#

let Messages = AddRoutingAddress(GenerateMessages(Pages feed, Links feed)) consume

update Messages := ComputeRouted(Messages feed) consume;